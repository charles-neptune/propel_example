
PARAMETERS p_test TYPE abap_bool DEFAULT abap_true.

DATA lv_cnt TYPE i.

FORM delete_table USING iv_tabname TYPE string.
  IF p_test = abap_true.
    SELECT COUNT(*) INTO lv_cnt FROM (iv_tabname).
    WRITE: / iv_tabname, ': would delete', lv_cnt, 'records'.
  ELSE.
    DELETE FROM (iv_tabname).
    lv_cnt = sy-dbcnt.
    WRITE: / iv_tabname, ': deleted', lv_cnt, 'records'.
  ENDIF.
ENDFORM.

START-OF-SELECTION.

WRITE: / 'FMBB Staging Table Cleanup'.
ULINE.

PERFORM delete_table USING 'ZFMBB_EXTIN'.
PERFORM delete_table USING 'ZFMBB_LTXT'.
PERFORM delete_table USING 'ZFMBB_SPRD'.
PERFORM delete_table USING 'ZFMBB_PRD'.
PERFORM delete_table USING 'ZFMBB_SITEM'.
PERFORM delete_table USING 'ZFMBB_ITEM'.
PERFORM delete_table USING 'ZFMBB_HDR'.

IF p_test = abap_false.
  COMMIT WORK.
  MESSAGE 'FMBB staging tables cleaned successfully.' TYPE 'S'.
ELSE.
  MESSAGE 'Test run only. No data deleted.' TYPE 'I'.
ENDIF.
